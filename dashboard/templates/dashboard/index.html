{% extends "portal/base.html" %}
{% load static %}

{% block title %}Tableau de bord ‚Äî OGSL{% endblock %}

{% block extra_head %}
  <!-- Chart.js pour les graphiques -->
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <!-- Style sp√©cifique au tableau de bord -->
  <link rel="stylesheet" href="{% static 'dashboard/css/style.css' %}" />
{% endblock %}

{% block content %}
<div class="container my-5">
  <!-- üß≠ Titre principal -->
  <h1 class="text-center mb-4 text-primary fw-bold">
    Tableau de bord OGSL
  </h1>

  <!-- üìä Statistiques principales -->
  <div class="row text-center g-3">
    <!-- Nombre de sources -->
    <div class="col-md-3">
      <div class="card shadow-sm p-3 border-0">
        <h6 class="text-muted mb-1">Sources</h6>
        <h2 class="text-success fw-bold">{{ sources_count }}</h2>
      </div>
    </div>

    <!-- Nombre d‚Äôorganisations -->
    <div class="col-md-3">
      <div class="card shadow-sm p-3 border-0">
        <h6 class="text-muted mb-1">Organisations</h6>
        <h2 class="text-warning fw-bold">{{ organizations_count }}</h2>
      </div>
    </div>

    <!-- Nombre de th√®mes -->
    <div class="col-md-3">
      <div class="card shadow-sm p-3 border-0">
        <h6 class="text-muted mb-1">Th√®mes</h6>
        <h2 class="text-info fw-bold">{{ themes_count }}</h2>
      </div>
    </div>

    <!-- Nombre de jeux de donn√©es -->
    <div class="col-md-3">
      <div class="card shadow-sm p-3 border-0">
        <h6 class="text-muted mb-1">Jeux de donn√©es</h6>
        <h2 class="text-danger fw-bold">{{ datasets_count }}</h2>
      </div>
    </div>
  </div>

  <!-- üìà Graphique 1 : r√©partition des jeux de donn√©es par source -->
  <div class="mt-5">
    <h4 class="text-center text-secondary mb-3">
      R√©partition des jeux de donn√©es par source
    </h4>
    <canvas id="datasetsChart" height="120"></canvas>
  </div>

  <!-- üéØ Filtre : s√©lectionner une source -->
  <div class="mt-5">
    <h4 class="text-center text-secondary">Filtrer par source</h4>
    <div class="d-flex justify-content-center mb-3">
      <select id="sourceFilter" class="form-select w-50">
        <option value="">-- Toutes les sources --</option>
        {% for source in sources %}
          <option value="{{ source.id }}">{{ source.name }}</option>
        {% endfor %}
      </select>
    </div>
  </div>

  <!-- üóÇÔ∏è Graphique 2 : r√©partition des jeux de donn√©es par th√®me -->
  <div class="mt-5">
    <h4 class="text-center text-secondary mb-3">
      R√©partition des jeux de donn√©es par th√®me
    </h4>
    <canvas id="datasetsByThemeChart" height="120"></canvas>
  </div>
</div>

<!-- üîç Bloc "√Ä propos du projet OGSL" -->
{% include 'portal/includes/about.html' %}
{% endblock %}

{% block extra_js %}
  <!-- Script principal pour les graphiques -->
  <script src="{% static 'dashboard/js/charts.js' %}"></script>
{% endblock %}
